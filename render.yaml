# Render Blueprint - Deploy all 15 services + Redis
# Single deployment for development (not recommended for production)
# https://render.com/docs/blueprint-spec

services:
  # ==================== PostgreSQL Services (8) ====================

  # Auth Service (3001)
  - type: web
    name: auth-service
    env: docker
    dockerfilePath: ./apps/auth-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3001
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: JWT_REFRESH_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # User Service (3002)
  - type: web
    name: user-service
    env: docker
    dockerfilePath: ./apps/user-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3002
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: ject-service
    env: docker
    dockerfilePath: ./apps/project-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3003
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: ment-service
    env: docker
    dockerfilePath: ./apps/payment-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3004
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: STRIPE_SECRET_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: CORS_ORIGIN
        value: "*"

  # Escrow Service (3012)
  - type: web
    name: esc
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3012
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: CORS_ORIGIN
        value: "*"

  # Dispute Service (3013)
  - type: web
    name: dis
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3013
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: ESCROW_SERVICE_URL
        value: "http://escrow-service.onrender.com"
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: CORS_ORIGIN
        value: "*"

  # Review Service (3014)
  - type: web
    name: review-service
    env: docker
    dockerfilePath: ./apps/review-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: CORS_ORIGIN
        value: "*"

  # Client Service (3011)
  - type: web
    name: client-service
    env: docker
    dockerfilePath: ./apps/client-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:DATABASE_URL
        sync: false
      - key: MONGODB_URI
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: STRIPE_SECRET_KEY
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # ==================== MongoDB Services (3) ====================

  # Message Service (3005)
  - type: web
    name: message-service
    env: docker
    dockerfilePath: ./apps/message-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3005
      - key: MONGODB_URI
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # Notification Service (3006)
  - type: web
    name: notification-service
    env: docker
    dockerfilePath: ./apps/notification-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3006
      - key: MONGODB_URI
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: SMTP_HOST
        sync: false
      - key: SMTP_PORT
        sync: false
      - key: SMTP_USER
        sync: false
      - key: SMTP_PASS
        sync: false
      - key: VAPID_SUBJECT
        sync: false
      - key: VAPID_PUBLIC_KEY
        sync: false
      - key: VAPID_PRIVATE_KEY
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: CORS_ORIGIN
        value: "*"

  # Worker Service (3010)
  - type: web
    name: worker-service
    env: docker
    dockerfilePath: ./apps/worker-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3010
      - key: : elastic
      - key: ELASTICSEARCH_PASSWORD
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # ==================== Special Services (4) ====================

  # Booking Service - Go (3007)
  - type: web
    name: booking-service
    env: docker
    dockerfilePath: ./apps/booking-service/Dockerfile
    dockerContext: ./apps/booking-service
    healthCheckPath: /health
    envVars:
      - key: PORT
        value: 3007
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString

  # Matching Service - Python (3008)
  - type: web
    name: matching-service
    env: docker
    dockerfilePath: ./apps/matching-service/Dockerfile
    dockerContext: ./apps/matching-service
    healthCheckPath: /health
    envVars:
      - key: PORT
        value: 3008
      - key: DATABASE_URL
        sync: false
      - key: MONGODB_URI
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # Session Service (3009)
  - type: web
    name: session-service
    env: docker
    dockerfilePath: ./apps/session-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3009
      - key: REDIS_URL
        fromService:
          type: redis
          name: tulifo-redis
          property: connectionString
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # Search Service (3015)
  - type: web
    name: search-service
    env: docker
    dockerfilePath: ./apps/search-service/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: : elastic
      - key: ELASTICSEARCH_PASSWORD
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGIN
        value: "*"

  # ==================== Infrastructure ====================

  # Redis - Shared cache for all services
  - type: redis
    name: tulifo-redis
    plan: starter
    ipAllowList: []